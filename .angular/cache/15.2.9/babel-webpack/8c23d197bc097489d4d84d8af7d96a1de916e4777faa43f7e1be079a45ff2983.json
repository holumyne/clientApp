{"ast":null,"code":"import { ShopParams } from '../shared/models/shopParams';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./shop.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../shared/paging-header/paging-header.component\";\nimport * as i4 from \"../shared/pager/pager.component\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"./product-item/product-item.component\";\nconst _c0 = [\"search\"];\nfunction ShopComponent_div_1_option_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const sort_r7 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"selected\", ctx_r1.shopParams.sort === sort_r7.value)(\"value\", sort_r7.value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(sort_r7.name);\n  }\n}\nfunction ShopComponent_div_1_li_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 21);\n    i0.ɵɵlistener(\"click\", function ShopComponent_div_1_li_9_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const brand_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.onBrandSelected(brand_r8.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const brand_r8 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", brand_r8.id === ctx_r2.shopParams.brandId);\n    i0.ɵɵproperty(\"value\", brand_r8.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(brand_r8.name);\n  }\n}\nfunction ShopComponent_div_1_li_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 21);\n    i0.ɵɵlistener(\"click\", function ShopComponent_div_1_li_13_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const type_r11 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.onTypeSelected(type_r11.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r11 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", type_r11.id === ctx_r3.shopParams.typeId);\n    i0.ɵɵproperty(\"value\", type_r11.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(type_r11.name);\n  }\n}\nfunction ShopComponent_div_1_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵelement(1, \"app-product-item\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const product_r14 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"product\", product_r14);\n  }\n}\nfunction ShopComponent_div_1_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"app-pager\", 25);\n    i0.ɵɵlistener(\"pageChanged\", function ShopComponent_div_1_div_26_Template_app_pager_pageChanged_1_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r15.onPageChanged($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"totalCount\", ctx_r6.totalCount)(\"pageSize\", ctx_r6.shopParams.pageSize)(\"pageNumber\", ctx_r6.shopParams.pageNumber);\n  }\n}\nfunction ShopComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"section\", 3)(2, \"h5\", 4);\n    i0.ɵɵtext(3, \"Sort\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"select\", 5);\n    i0.ɵɵlistener(\"change\", function ShopComponent_div_1_Template_select_change_4_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.onSortSelected($event));\n    });\n    i0.ɵɵtemplate(5, ShopComponent_div_1_option_5_Template, 2, 3, \"option\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"h5\", 4);\n    i0.ɵɵtext(7, \"Brands\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ul\", 7);\n    i0.ɵɵtemplate(9, ShopComponent_div_1_li_9_Template, 2, 4, \"li\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"h5\", 4);\n    i0.ɵɵtext(11, \"Types\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"ul\", 7);\n    i0.ɵɵtemplate(13, ShopComponent_div_1_li_13_Template, 2, 4, \"li\", 8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"section\", 9)(15, \"div\", 10);\n    i0.ɵɵelement(16, \"app-paging-header\", 11);\n    i0.ɵɵelementStart(17, \"div\", 12)(18, \"input\", 13, 14);\n    i0.ɵɵlistener(\"keyup.enter\", function ShopComponent_div_1_Template_input_keyup_enter_18_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.onSearch());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function ShopComponent_div_1_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.onSearch());\n    });\n    i0.ɵɵtext(21, \"Search\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ShopComponent_div_1_Template_button_click_22_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.onReset());\n    });\n    i0.ɵɵtext(23, \"Reset\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(24, \"div\", 17);\n    i0.ɵɵtemplate(25, ShopComponent_div_1_div_25_Template, 2, 1, \"div\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(26, ShopComponent_div_1_div_26_Template, 2, 3, \"div\", 19);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.sortOptions);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.brands);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.types);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"totalCount\", ctx_r0.totalCount)(\"pageNumber\", ctx_r0.shopParams.pageNumber)(\"pageSize\", ctx_r0.shopParams.pageSize);\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.products);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.totalCount > 0);\n  }\n}\nexport let ShopComponent = /*#__PURE__*/(() => {\n  class ShopComponent {\n    constructor(shopService) {\n      this.shopService = shopService;\n      this.products = []; //where to store the response we got from our Api with an initial value of empty array.\n      this.brands = [];\n      this.types = [];\n      this.sortOptions = [{\n        name: 'Alphabetical',\n        value: 'name'\n      }, {\n        name: 'Price: Low to high',\n        value: 'priceAsc'\n      }, {\n        name: 'Price: High to low',\n        value: 'priceDesc'\n      }];\n      this.totalCount = 0;\n      this.shopParams = shopService.getShopParams(); //now initializing this property inside the constructor\n    }\n\n    ngOnInit() {\n      this.getProducts();\n      this.getBrands();\n      this.getTypes();\n    }\n    getProducts() {\n      // this.shopService.getProducts(this.brandIdSelected, this.typeIdSelected, this.sortSelected).subscribe({\n      this.shopService.getProducts().subscribe({\n        next: response => {\n          this.products = response.data; //what to do next--return the product as response        \n          //  this.shopParams.pageNumber = response.pageIndex;\n          //  this.shopParams.pageSize = response.pageSize; we dont need both anymore becos now stored in our service\n          this.totalCount = response.count;\n        },\n        error: error => console.log(error),\n        complete: () => {\n          console.log('request completed');\n        }\n      });\n    }\n    getBrands() {\n      this.shopService.getBrands().subscribe({\n        // next: response => this.brands = response, //the reponse here is a brand array becos we don't hv a pagination here\n        next: response => this.brands = [{\n          id: 0,\n          name: 'All'\n        }, ...response],\n        error: error => console.log(error),\n        complete: () => {\n          console.log('request completed');\n        }\n      });\n    }\n    getTypes() {\n      this.shopService.getTypes().subscribe({\n        next: response => this.types = [{\n          id: 0,\n          name: 'All'\n        }, ...response],\n        error: error => console.log(error),\n        complete: () => {\n          console.log('request completed');\n        }\n      });\n    }\n    onBrandSelected(brandId) {\n      const params = this.shopService.getShopParams();\n      params.brandId = brandId;\n      params.pageNumber = 1;\n      this.shopService.setShopParams(params);\n      this.shopParams = params;\n      this.getProducts();\n    }\n    onTypeSelected(typeId) {\n      const params = this.shopService.getShopParams();\n      params.typeId = typeId;\n      params.pageNumber = 1;\n      this.shopService.setShopParams(params);\n      this.shopParams = params;\n      this.getProducts();\n    }\n    onSortSelected(event) {\n      const params = this.shopService.getShopParams();\n      params.sort = event.target.value;\n      this.shopService.setShopParams(params);\n      this.shopParams = params;\n      this.getProducts();\n    }\n    onPageChanged(event) {\n      const params = this.shopService.getShopParams();\n      if (params.pageNumber !== event) {\n        params.pageNumber = event;\n        this.shopService.setShopParams(params);\n        this.shopParams = params;\n        this.getProducts();\n      }\n    }\n    onSearch() {\n      const params = this.shopService.getShopParams();\n      params.search = this.searchTerm?.nativeElement.value;\n      params.pageNumber = 1;\n      this.shopService.setShopParams(params);\n      this.shopParams = params;\n      this.getProducts();\n    }\n    onReset() {\n      if (this.searchTerm) this.searchTerm.nativeElement.value = '';\n      this.shopParams = new ShopParams();\n      this.shopService.setShopParams(this.shopParams);\n      this.getProducts();\n    }\n  }\n  ShopComponent.ɵfac = function ShopComponent_Factory(t) {\n    return new (t || ShopComponent)(i0.ɵɵdirectiveInject(i1.ShopService));\n  };\n  ShopComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ShopComponent,\n    selectors: [[\"app-shop\"]],\n    viewQuery: function ShopComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.searchTerm = _t.first);\n      }\n    },\n    decls: 2,\n    vars: 1,\n    consts: [[1, \"container\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"row\"], [1, \"col-3\"], [1, \"text-warning\", \"ms-3\"], [1, \"form-select\", \"mb-4\", 3, \"change\"], [3, \"selected\", \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"list-group\", \"my-3\"], [\"class\", \"list-group-item\", 3, \"active\", \"value\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-9\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"pb-2\"], [3, \"totalCount\", \"pageNumber\", \"pageSize\"], [1, \"d-flex\", \"mt-2\"], [\"type\", \"text\", \"placeholder\", \"Search\", 1, \"form-control\", \"me-2\", 3, \"keyup.enter\"], [\"search\", \"\"], [1, \"btn\", \"btn-outline-primary\", \"mx-2\", 3, \"click\"], [1, \"btn\", \"btn-outline-success\", 3, \"click\"], [1, \"row\", \"row-cols-3\", \"g-3\", \"mb-4\"], [\"class\", \"col\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"d-flex justify-content-center\", 4, \"ngIf\"], [3, \"selected\", \"value\"], [1, \"list-group-item\", 3, \"value\", \"click\"], [1, \"col\"], [3, \"product\"], [1, \"d-flex\", \"justify-content-center\"], [3, \"totalCount\", \"pageSize\", \"pageNumber\", \"pageChanged\"]],\n    template: function ShopComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, ShopComponent_div_1_Template, 27, 8, \"div\", 1);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.types.length > 0 && ctx.brands.length > 0);\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.PagingHeaderComponent, i4.PagerComponent, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i6.ProductItemComponent],\n    styles: [\".list-group-item[_ngcontent-%COMP%]{cursor:pointer;border:none;padding:10px 20px;font-size:1.1em}.list-group-item.active[_ngcontent-%COMP%]{border-radius:10px}.list-group-item[_ngcontent-%COMP%]:not(.active):hover{color:#fff;background-color:#e95420b3;border-radius:10px}\"]\n  });\n  return ShopComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}